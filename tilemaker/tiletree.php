<?php

require_once (dirname(__FILE__) . '/clip.php');
require_once (dirname(__FILE__) . '/tree.php');
require_once (dirname(__FILE__) . '/tree_order.php');
require_once (dirname(__FILE__) . '/hsl.php');

define('TILESIZE', 512);
define('FONTSIZE', 10);

define('MAXLABELENGTH', 40);

define('ZEBRA', 0); // make zebra lines

//--------------------------------------------------------------------------------------------------
function world_to_pixel($world_pt, $zoom)
{
	$pixel_pt = array('x' => 0, 'y' => 0);

	$pixel_pt['x'] = $world_pt['x'];
	$pixel_pt['y'] = $world_pt['y'] * pow(2, $zoom);

	return $pixel_pt;
}



//--------------------------------------------------------------------------------------------------
// A subtree as a polygon
// Note that we visit the nodes in the order required to draw them as a SVG polgon
function get_subtree ($p, $zoom = 0, $slice = 0)
{
	$subtree = new stdclass;	
	$subtree->polygon 	= array();
	$subtree->label 	= '';
	$subtree->user_label = false;
	$subtree->leftmost 	= null;
	$subtree->rightmost = null;
	$subtree->top		= array('x' => 0, 'y' => '0');
	$subtree->bottom	= array('x' => 0, 'y' => '0');
		
	// subtree root

	$left_most_pt = $p->GetAttribute('xy');
	$a = world_to_pixel($left_most_pt, $zoom);
	$a['y'] -= ($slice * TILESIZE);
	$subtree->polygon[] = $a;

	// go up subtree to left-most descendant (topmost in drawing)
	$q = $p->GetChild();
	while ($q)
	{
		$subtree->leftmost = $q;

		$left_most_pt = $q->GetAttribute('xy');		
		$a = world_to_pixel($left_most_pt, $zoom);
		
		$ancestor_pt = $q->GetAncestor()->GetAttribute('xy');
		$ancestor_pt['y'] = $left_most_pt['y'];
		
		$b = world_to_pixel($ancestor_pt, $zoom);

		// Make relative to this tile
		$a['y'] -= ($slice * TILESIZE);
		$b['y'] -= ($slice * TILESIZE);
		
		// Store
		$subtree->polygon[] = $b;
		$subtree->polygon[] = $a;
		
		$subtree->top = $a;
		
		$q = $q->GetChild();
	}
	
	// now go to right most sibling
	
	$right = array();
	$q = $p->GetChild()->GetRightMostSibling();
	
	$right_most_pt = $q->GetAttribute('xy');
		
	$lastPt = $q->GetAttribute('xy');
	
	while ($q)
	{
		$subtree->rightmost = $q;
	
		$right_most_pt = $q->GetAttribute('xy');
		$a = world_to_pixel($right_most_pt, $zoom);
		
		$ancestor_pt = $q->GetAncestor()->GetAttribute('xy');
		$ancestor_pt['y'] = $right_most_pt['y'];
		
		$b = world_to_pixel($ancestor_pt, $zoom);

		// Make relative to this tile
		$a['y'] -= ($slice * TILESIZE);
		$b['y'] -= ($slice * TILESIZE);
		
		// Put at start of list of points
		array_unshift($right, $b);
		array_unshift($right, $a);
		
		$subtree->bottom = $a;
				
		$q = $q->GetChild();
		if ($q)
		{
			$q = $q->GetRightMostSibling();
		}
	}
	
	// Square up the polygon for nicer display
	if ($left_most_pt['x'] >  $right_most_pt['x'])
	{
		// left most child extend further out than right most
		
		$pt = array(
			'x' => $left_most_pt['x'],
			'y' => $right_most_pt['y']
			);
		$b = world_to_pixel($pt, $zoom);
		$b['y'] -= ($slice * TILESIZE);
	
		// insert this at start of rightmost list
		array_unshift($right, $b);
		
		$subtree->bottom = $b;
		
	}
	else
	{
		$pt = array(
			'x' => $right_most_pt['x'],
			'y' => $left_most_pt['y']
			);
		$b = world_to_pixel($pt, $zoom);
		$b['y'] -= ($slice * TILESIZE);
	
		$subtree->polygon[] = $b;	
		
		$subtree->top = $b;
	}
	
	// Add right most points to polygon
	$subtree->polygon = array_merge($subtree->polygon, $right);
	
	// Create a label for this subtree. If the tree has a user-supplied one then
	// use that, otherwise generate one from the left and right labels.
	// To do: note that generated label might not be unique (implications for searching tree)
	$subtree->label = $p->GetLabel();
	
	// if internal label is a number, it's probably just a bootstrap value, so ignore it
	if (is_numeric($subtree->label))
	{
		$subtree->label = '';
	}
	
	if ($subtree->label == '')
	{
		// if there is a common substring in the two labels we could use that
		$common = '';
		
		// BOLD
		if ($common == '')
		{
			// Test for common identifier (e.g., BOLD)
			if (preg_match('/(?<bold>BOLD[:|-]\w+\d+)/', $subtree->leftmost->GetLabel(), $m1)
			 && preg_match('/(?<bold>BOLD[:|-]\w+\d+)/', $subtree->rightmost->GetLabel(), $m2))
			{
				$common = $m1['bold'];
				if ($m2['bold'] != $m1['bold'])
				{
					$common .= '...' . $m2['bold'];
				}
			}
		}
		
		// Genus name
		if ($common == '')
		{
			// Test for common identifier (e.g., BOLD)
			if (preg_match('/^(?<genus>[A-Z]\w+)[\s|_]/', $subtree->leftmost->GetLabel(), $m1)
			 && preg_match('/^(?<genus>[A-Z]\w+)[\s|_]/', $subtree->rightmost->GetLabel(), $m2))
			{
				$common = $m1['genus'];
				if ($m2['genus'] != $m1['genus'])
				{
					$common .= '...' . $m2['genus'];
				}
			}
		}
		
		
		if ($common != '')
		{
			$subtree->label = $common;
		}
		else
		{
			$subtree->label = substr($subtree->leftmost->GetLabel(), 0, 10) . '...' . substr($subtree->rightmost->GetLabel(), 0, 10);
		}
	}
	else
	{
		$subtree->user_label = true;
	}
	
	return $subtree;
}



//--------------------------------------------------------------------------------------------------
function make_tiles ($treestring, $path, $format='newick', $treeid = '', $translate = array())
{
	//----------------------------------------------------------------------------------------------
	// Parse tree and make it pretty by ordering it
	$t = new Tree();
	if ($format == 'newick')
	{
		$t->ParseHarder($treestring);
	}
	else
	{
		// nexus
		$t->Parse($treestring);	
		
		if (count($translate) > 0)
		{
			$pi = new NodeIterator($t->getRoot());
			$q = $pi->Begin();
			while ($q != NULL)
			{	
				if ($q->IsLeaf())
				{
					$q->SetLabel($translate[$q->GetLabel()]);
				}
				$q = $pi->Next();
			}	
		}
				
		
		
		
		
	}
	$t->BuildWeights($t->GetRoot());
	
	
	$RO = new RightOrder($t);
	$RO->Order();
	
	// get leaf order and use it to colour the tree (unless we have any user-supplied colours?)
	$leaf_counter = 0;
	{
		$pi = new NodeIterator($t->getRoot());
		$q = $pi->Begin();
		while ($q != NULL)
		{	
			$q->SetAttribute('left_span', $t->GetNumLeaves());
			$q->SetAttribute('right_span', 0);
			$q = $pi->Next();
		}	
	}
	{
		$pi = new NodeIterator($t->getRoot());
		$q = $pi->Begin();
		while ($q != NULL)
		{	
			if ($q->IsLeaf())
			{
				$q->SetAttribute('left_span', $leaf_counter);
				$q->SetAttribute('right_span', $leaf_counter);
				$leaf_counter++;
			}
			if ($q->GetAncestor())
			{
				$q->GetAncestor()->SetAttribute('left_span', min($q->GetAttribute('left_span'), $q->GetAncestor()->GetAttribute('left_span')));
				$q->GetAncestor()->SetAttribute('right_span', max($q->GetAttribute('right_span'),$q->GetAncestor()->GetAttribute('right_span')));
			}
			$q = $pi->Next();
		}	
	}
	
	
	//----------------------------------------------------------------------------------------------
	// World coordinates of tree...
	
	
	$attr = array();
	$attr['width'] 			= TILESIZE;
	$attr['width'] 			= TILESIZE/2.0;
	$attr['height'] 		= TILESIZE;
	$attr['inset'] 			= FONTSIZE;
	
	// Untested
	$td = null;
	if ($t->HasBranchLengths())
	{
		$td = new PhylogramTreeDrawer($t, $attr);
	}
	else
	{
		$td = new RectangleTreeDrawer($t, $attr);
	}
	
	$td->CalcCoordinates();
	
		{
			$pi = new NodeIterator($t->getRoot());
			$q = $pi->Begin();
			while ($q != NULL)
			{	
				$pt = $q->GetAttribute('xy');			
				//echo $pt['x'] . "\t" . $pt['y'] . "\n";
				$q = $pi->Next();
			}	
		}
	
	
	//----------------------------------------------------------------------------------------------
	
	// Create search "database" of node labels
	
	$otus=array();
	
	// Store labels for each layer 
	
	$layer_labels = array();
	
	//----------------------------------------------------------------------------------------------
	
	// Generate tiles...
	
	if ($treeid == '')
	{
		$treeid = md5($treestring);
	}
	
	$tile_path = $path . '/' . $treeid;
	
	if (!file_exists($tile_path))
	{
		$oldumask = umask(0); 
		mkdir($tile_path, 0777);
		umask($oldumask);
	}
	
	$basename = $tile_path . '/tile';
	
	// To do: compute appropriate zoom level
	
	
	
	//$max_zoom = 7; 
	
	$max_zoom = 0;
	$s = $td->leaf_gap * pow(2, $max_zoom);
	while ($s < (FONTSIZE * 2))
	{
		$max_zoom++;
		$s = $td->leaf_gap * pow(2, $max_zoom);
	}
	$max_zoom++;
	
	//echo "max zoom=$max_zoom $s ";
	//exit();
	
	$view_height = TILESIZE;
	$view_width = TILESIZE;
	
	// For each level traverse tree and output tiles
	for ($zoom = 0; $zoom < $max_zoom; $zoom++)
	{
		echo "zoom=$zoom\n";
		
		$layer_labels[$zoom] = array();
		
		// Number of tiles
		$slices = pow(2, $zoom);
		
		$height = TILESIZE *  $slices;
		$width = $view_width;
			
		// identify which nodes we will draw as polygons and
		// which we draw as lines
		
		// clear flags
		{
			$pi = new NodeIterator($t->getRoot());
			$q = $pi->Begin();
			while ($q != NULL)
			{	
				$q->SetAttribute('style', 'none');
				$q->SetAttribute('stop', false);
				$q = $pi->Next();
			}	
		}
		
		$pi = new PreorderIterator($t->getRoot());
		$q = $pi->Begin();
		while ($q != NULL)
		{	
			
			$q->SetAttribute('style', 'line');
		
			// If this is an internal node do we draw it as a tree or as a polygon?
			if ($q->IsLeaf ())
			{
			}
			else
			{
				// get spacing between desendants
				//echo "---\n";
				$r = $q->GetChild();
				$sib = $r->GetSibling();
				while ($sib)
				{			
					$a = world_to_pixel($r->GetAttribute('xy'), $zoom);
					$b = world_to_pixel($sib->GetAttribute('xy'), $zoom);
					
					$gap = $b['y'] - $a['y'];
	
					//echo $gap . "\n";
					
					// stopping rule
					if ($gap < (FONTSIZE * 2))
					{
						$q->SetAttribute('stop', true);
						$q->SetAttribute('style', 'polygon');
					}
					
					$r = $sib;
					$sib = $sib->GetSibling();			
				}
			}
				
			$q = $pi->Next();
		}	
		
		
		// draw each "slice" (i.e, a tile), clipped and transformed 
		// so origin is always (0,0). Each tile is a standalone SVG image
		for ($i = 0; $i < $slices; $i++)
		{
			
		
		
			$clipRect = new Rectangle(0, TILESIZE * $i, TILESIZE, TILESIZE);
			
			// inflate vertically so that we don't clip text labels 
			// For example, a node my be out of the clip region but it's text label may extend into the
			// current region
			$clipRect->Inflate (0, FONTSIZE);
		
			$p = new SVGPort("tile" . $i, TILESIZE, TILESIZE );
			
			
			if (ZEBRA)
			{
				if ($zoom > 1)
				{
					foreach ($layer_labels[$zoom-1] as $label)
					{
						$pt0 = array('x'=>0, 'y' => $label->top);
						$pt1 = array('x'=>TILESIZE, 'y' => $label->bottom);
						
						
						$a = world_to_pixel($pt0, $zoom);
						$b = world_to_pixel($pt1, $zoom);
						
						if (CohenSutherlandLineClipAndDraw($a, $b, $clipRect))
						{
						$a = world_to_pixel($pt0, $zoom);
						$b = world_to_pixel($pt1, $zoom);
						
							$a['y'] -= ($i * TILESIZE);
							$b['y'] -= ($i * TILESIZE);
							
							//$p->DrawLine($a,$b);
							$p->DrawRect($a, $b, hslToRgb($label->h,0.5,0.95));
			
							
							// label
							//$p->DrawText($a, $label->text); 
						}
					}
				}
			}		
			
			// Traverse tree
		
			$n = new NodeIterator ($t->getRoot());
					
			$q = $n->Begin();
			while ($q != NULL)
			{	
				$style = $q->GetAttribute('style');
				if ($style)
				{
					switch ($style)
					{
						case 'polygon':
							// create polygon
							$subtree = get_subtree($q, $zoom, $i);
							
							// color
							$h = $q->GetAttribute('left_span')/$t->GetNumLeaves() * 360;
							
							if (ZEBRA)
							{
								// Store label
								$label = new stdclass;
								$label->text = $subtree->label;
								//$label->top = $subtree->leftmost->GetAttribute('xy')['y'];
								//$label->bottom = $subtree->rightmost->GetAttribute('xy')['y'];
								$label->h = $q->GetAttribute('left_span')/$t->GetNumLeaves() * 360;
								$layer_labels[$zoom][] = $label;
							}						
							
							// clip test (To do:)
							// get coordinates of vertical part of polygon
							$polygon_top = $subtree->top;
							$polygon_bottom = $subtree->bottom;
							
							// restore to coordinates relative to entire tree at this zoom level
							$polygon_top['y'] += ($i * TILESIZE);
							$polygon_bottom['y'] += ($i * TILESIZE);
							
							
												
							// if this is in the clip rect the draw
							if (CohenSutherlandLineClipAndDraw($polygon_top, $polygon_bottom, $clipRect))
							{
								// draw
								$p->DrawPolygon($subtree->polygon, hslToRgb($h,1,0.7));
								
								// draw label									
								$labelpt = array(
									'x'=> $subtree->top['x'],
									'y' => $subtree->top['y'] + ($subtree->bottom['y'] - $subtree->top['y'])/2.0
									);
								$labelpt['x'] += FONTSIZE/2.0;
								$p->DrawText($labelpt, $subtree->label); 
								
								/*
								// Store user-supplied subtree labels so that we can search on them
								if ($subtree->user_label)
								{ 									
									$otu = new stdclass;
									$otu->text = $subtree->label;
									$otu->tile = $i;
									$otu->zoom = $zoom;
									$otu->y    = $labelpt['y'];
									$otus[$subtree->label] = $otu;
								}
								*/
								
							}
							
							
							// line to anc							
							$anc = $q->GetAncestor();
							
							if ($anc)
							{
								$a = world_to_pixel($q->GetAttribute('xy'), $zoom);
								$b = world_to_pixel($anc->GetAttribute('xy'), $zoom);
								$b['y'] = $a['y'];
						
								if (CohenSutherlandLineClipAndDraw($a, $b, $clipRect))
								{
									$a['y'] -= ($i * TILESIZE);
									$b['y'] -= ($i * TILESIZE);
									$p->DrawLine($a,$b);
									
								}
							}						
							break;
							
						case 'line':										
							if ($q->IsLeaf ())
							{
								// line from leaf back to ancestor
								$a = world_to_pixel($q->GetAttribute('xy'), $zoom);
								$anc = $q->GetAncestor();
								$b = world_to_pixel($anc->GetAttribute('xy'), $zoom);
								$b['y'] = $a['y'];
												
								if (CohenSutherlandLineClipAndDraw($a, $b, $clipRect))
								{
									$a['y'] -= ($i * TILESIZE);
									$b['y'] -= ($i * TILESIZE);
									$p->DrawLine($a,$b);
									
									$labelpt = $a;
									$labelpt['x'] += FONTSIZE/2.0;
									
									$label = $q->Getlabel();
									$len = strlen($label);
									if ($len > MAXLABELENGTH)
									{
										$label = substr($label, 0, MAXLABELENGTH) . 'â€¦';
									}
									
									
									$p->DrawText($labelpt, $label); 
								}
							}
							else
							{
								$a = world_to_pixel($q->GetAttribute('xy'), $zoom);
								if ($q->GetAncestor())
								{
									$anc = $q->GetAncestor();
									$b = world_to_pixel($anc->GetAttribute('xy'), $zoom);
									$b['y'] = $a['y'];
									
									if (CohenSutherlandLineClipAndDraw($a, $b, $clipRect))
									{
										$a['y'] -= ($i * TILESIZE);
										$b['y'] -= ($i * TILESIZE);
										$p->DrawLine($a,$b);
									}
								}
								
								// vertical line spanning left and right immediate descendants
								$leftpt = world_to_pixel($q->GetChild()->GetAttribute('xy'), $zoom);
								$b = world_to_pixel($q->GetChild()->GetRightMostSibling()->GetAttribute('xy'), $zoom);
								
								$a['y'] = $leftpt['y'];
								$b['x'] = $a['x'];
								if (CohenSutherlandLineClipAndDraw($a, $b, $clipRect))
								{
									$a['y'] -= ($i * TILESIZE);
									$b['y'] -= ($i * TILESIZE);
									$p->DrawLine($a,$b);
								}							
	
							}
							break;
							
						default:
							break;
					}
				}
			
				$q = $n->Next();
			}
			
			// Output this tile
			$svg_filename = $basename . '-' . $zoom . '-' . $i . '.svg';
			$file = fopen($svg_filename, "w");
			fwrite($file, $p->GetOutput());
			fclose($file);
		}	
		
		
	}
	
	//print_r($layer_labels);

}

// test
if (0)
{
	$treestring='(((((((((((((((((((((((((((((((((AB332438:0.002138,(((((((((AB332451:0.002113,((AB332966:0.001695,AB333554:0.000297):0.000578,AB333255:0.001422):-0.000301):0.001243,AB332495:0.006812):-0.001033,AB332588:0.000321):-2.310e-05,AB333284:0.002240):-6.480e-05,AB333058:0.000234):-2.936e-05,AB333096:0.000205):-2.287e-05,AB333119:0.000182):-1.833e-05,AB333132:0.000164):-1.502e-05,AB333402:0.000149):-1.321e-05):0.001221,(AB333104:0.000249,AB333674:0.001751):0.000897):-0.000613,AB332529:0.001802):0.001213,AB332492:0.002614):-0.000179,(((AB332537:0.002006,AB333637:-6.080e-06):-5.977e-05,((((AB332655:0,AB332910:0):0,AB333125:0):0,AB333661:0):0,AB333678:0):6.389e-05):0.000747,AB332997:0.003227):0.000375):0.001149,((((((((((((((((((((((((((((((((AB332452:0.002290,((AB332616:0.002879,AB333630:0.003121):-0.000437,AB333711:0.002437):-0.000144):6.364e-05,AB332986:0.002081):0.000623,AB332686:0.001426):0.000218,AB332481:0.001400):-0.000546,((AB332552:0.000534,(AB332758:0.002498,AB333030:0.001494):-0.000532):-0.000178,AB332813:0.000356):0.000300):-0.000269,AB333689:0.006300):0.000776,AB332812:0.003474):-0.000807,AB332864:0.000361):-2.604e-05,AB333122:0.000335):-2.260e-05,AB333139:0.000313):-1.981e-05,AB333157:0.000294):-1.750e-05,AB333167:0.000277):-1.558e-05,AB333274:0.000262):-1.396e-05,AB333412:0.000248):-1.259e-05,AB333474:0.000236):-1.140e-05,AB333485:0.000225):-1.038e-05,AB333726:0.000215):0.000782,AB332574:0.001415):0.000261,AB332788:0.001203):-7.463e-05,AB332546:0.001341):-0.000146,AB333735:0.001538):-0.000662,AB333657:0.002247):0.001263,(AB332496:0.001626,AB332661:0.002374):0.001968):-0.001268,AB333377:0.002363):0.001162,AB333253:0.001177):-0.000389,(AB333366:0.003465,AB333588:0.004535):0.001618):0.000398,AB333458:0.001264):4.246e-05,AB333093:0.003262):-0.000369,(AB333363:0.001124,AB333515:0.002876):-0.000249):0.000588,(AB332719:0.001824,((AB332942:0.000452,(AB333181:0.003124,AB333241:0.002876):-0.000452):0.000542,AB333488:0.001609):-1.992e-05):0.001011):0.000513,(((AB333345:0,AB333553:0):6.495e-05,AB333444:-6.495e-05):0.001877,(AB333445:0.002066,AB333706:0.001934):9.897e-05):0.000419):0.000207,(AB333298:0.001629,(AB333430:0.001730,AB333667:0.002270):0.000380):0.000707):4.931e-05):0.000436,(AB332488:0.004456,AB333477:0.003544):0.001243):-0.000772,AB333189:0.002618):0.000812,AB332503:0.003005):0.000706,((((((((((((AB332444:0.000322,((((((((((((((((AB332447:0.003178,AB332619:0.000822):0.000510,(((AB332562:-7.695e-07,(AB332879:0.003999,AB333560:0.002001):7.696e-07):2.569e-07,AB333507:-5.134e-07):0.000854,(AB333331:0.001426,AB333714:0.000574):0.001146):0.000872):5.479e-05,(((AB333020:0.006202,AB333545:0.003798):-3.552e-06,AB333270:0.006004):0.000515,AB333521:0.003486):0.000193):1.456e-05,(((((((((AB332611:0.003498,AB333069:0.004502):0.000256,AB332645:0.003744):-0.000240,(AB333078:0.000269,AB333559:0.001731):0.002822):-0.000522,(AB333348:0.001759,AB333659:0.002241):0.000687):2.115e-06,(AB333106:0.002705,AB333204:0.001295):0.000292):-0.000418,AB333738:0.000580):-5.840e-05,AB333660:0.000522):-4.786e-05,AB333609:0.000475):-3.994e-05,AB333501:0.000436):0.000504):-0.000477,AB333486:0.000472):-1.848e-05,AB333317:0.000454):-1.714e-05,AB333286:0.000437):-1.594e-05,AB333242:0.000422):-1.486e-05,AB333206:0.000408):-1.389e-05,AB333014:0.000394):-1.302e-05,AB332925:0.000382):-1.222e-05,AB332897:0.000370):-1.150e-05,AB332895:0.000359):-1.084e-05,AB332870:0.000349):-1.024e-05,AB332825:0.000339):-9.683e-06,AB332824:0.000330):-9.173e-06):0.000366,((((AB332761:0.002109,AB332935:0.001895):-0.000717,AB332926:0.002717):-0.000364,AB333033:0.002604):-0.000153,AB333611:0.002455):0.000213):0.000297,AB333283:0.001655):5.538e-06,AB333159:0.001665):-7.484e-05,(AB332613:0.002747,(AB332901:9.751e-05,(AB333296:0.003155,AB333382:0.000845):-8.453e-05):0.000609):0.000131):-0.000567,AB333503:0.002362):0.000448,AB333133:0.001899):-7.390e-06,((AB332688:0.003511,(AB332844:0.002230,(((((AB332885:0.001084,AB333160:0.000912):-0.000176,AB333193:0.000176):0.000439,AB333582:0.001616):-0.000406,AB333369:0.000217):-4.351e-05,AB333465:0.000174):-9.354e-05):0.000920):-0.000765,AB333626:0.000402):0.000234):0.000880,AB332669:0.003066):0.000161,AB333323:0.002944):-0.000597,AB333384:0.001557):0.002376,AB333416:0.003197):0.000144):-0.000623,((((((AB332474:3.968e-07,AB332779:0.002000):2.047e-05,AB333367:0.001980):0.001512,(AB333021:0.001049,AB333272:0.002951):0.000481):0.001067,AB332589:0.003030):-0.000643,(AB332698:0.000152,AB333258:-0.000152):0.001994):-0.000634,(AB332649:0.002687,AB332937:0.003313):0.002630):0.001025):0.000185,((((((AB332548:0.000844,AB333572:0.003148):0.001224,(((((((((AB332559:0.000253,(AB332727:0.001247,(AB332893:0.001998,AB333718:0.002002):0.000753):-0.000504):-6.346e-05,AB332662:0.000190):-3.814e-05,AB332684:0.000152):-2.546e-05,AB332716:0.000127):-1.821e-05,AB332793:0.000109):-1.368e-05,AB333136:9.534e-05):-1.066e-05,AB333239:8.481e-05):-8.539e-06,AB333388:7.639e-05):-6.997e-06,AB333520:6.950e-05):0.000841):-0.000265,AB332819:0.001705):-0.000341,AB333734:0.002085):-3.417e-05,AB332923:0.002129):0.000625,((AB332575:0.001998,AB333094:2.234e-06):6.292e-05,AB333072:-6.491e-05):0.001450):0.001783):0.001488,AB333705:0.005333):0.032722,AB333575:0.031861):-0.017165,(AB332717:0.002467,AB332845:0.003521):0.014732):0.017974,AB333457:0.029103):0.029884,((((((((AB332443:0.000306,AB333191:0.001694):0.001836,((((((((((((((AB332461:0.000494,(((((((((AB332464:7.705e-06,AB332675:-7.705e-06):3.855e-06,AB332703:-3.855e-06):0.000690,AB332773:0.001311):-0.000517,AB333275:0.000170):0.001572,AB332544:0.000542):0.000795,AB333576:0.005563):-0.000889,AB332839:0.002576):-6.357e-05,AB333103:0.002495):0.000895,AB333324:0.001490):-0.000904):-4.527e-05,AB332587:0.000450):-3.779e-05,AB332835:0.000413):-3.202e-05,AB332890:0.000381):-2.749e-05,AB333044:0.000354):-2.386e-05,AB333143:0.000331):-2.091e-05,AB333437:0.000310):-1.848e-05,AB333502:0.000292):-1.645e-05,AB333505:0.000276):-1.474e-05,AB333750:0.000262):0.000578,AB333001:0.003659):0.000598,AB332579:0.001092):0.000551,AB333578:0.004625):-0.000962,AB333570:0.001706):-0.000106):0.000926,AB333304:0.002960):-0.000150,(AB333276:0.006065,AB333530:-6.519e-05):0.001171):0.002155,AB333653:0.003125):-0.001082,AB333567:0.004399):0.000653,((((((((((((((AB332530:0.001406,((((((((((((((((((((((((((((((((((AB332543:0.005273,AB332595:0.004727):0.001951,AB333535:0.004075):-0.000793,AB333739:0.002816):-9.855e-05,AB333613:0.002507):8.568e-05,(AB332558:-0.000404,AB333095:0.000404):0.001224):-0.000423,AB333717:0.002513):-6.769e-05,AB333519:0.002454):-5.478e-05,(AB333015:0,AB333120:0):0.002408):6.160e-05,AB333720:0.002198):0.000348,(AB332569:0.003247,AB333490:0.002753):0.001819):-0.000468,AB332988:0.002337):0.000118,AB333198:0.004174):-0.000152,AB332593:0.000304):-1.809e-05,AB332618:0.000286):-1.611e-05,AB332627:0.000271):-1.443e-05,AB332750:0.000256):-1.301e-05,AB332828:0.000244):-1.179e-05,AB332842:0.000232):-1.073e-05,AB332932:0.000222):-9.814e-06,AB333185:0.000213):-9.010e-06,AB333267:0.000204):-8.302e-06,AB333383:0.000196):-7.675e-06,AB333471:0.000188):-7.117e-06,AB333558:0.000182):-6.619e-06,AB333740:0.000175):0.000776,AB333002:0.001387):0.000419,AB333114:0.001008):-0.001156,AB333396:0.002229):0.000295,AB333054:0.001919):0.000360,AB332560:0.003564):0.000134,AB333761:0.003455):0.000339,AB333237:0.003147):0.000876,(AB333509:0.002005,AB333534:-4.822e-06):0.002318):-0.000704,(AB332577:0.001620,(AB332581:0.003859,(AB333063:0.001699,AB333067:0.002301):0.000141):0.000336):0.000993):-5.277e-05):-0.000383,AB333037:0.001817):0.000419,AB333441:0.003406):4.043e-05,AB333259:0.001393):0.002263,(AB333146:0.003584,AB333395:0.004416):-0.000843):-0.002255,((AB332705:0,AB332973:0):0.000666,AB333562:0.003334):0.001425):0.001534,(((AB332676:0.001997,AB333442:0.002003):0.000745,AB332991:0.001255):0.001114,AB333579:0.005305):0.000808):-0.001474,((AB332745:0.001240,AB332929:0.000760):0.001616,AB332770:0.000384):0.000692):2.613e-05,AB333217:0.001882):0.000198,AB332847:0.001689):-7.140e-05,AB333008:0.001770):0.000590,AB333623:0.007154):0.000204,(AB333580:0.003146,AB333602:0.000854):0.001010):0.000128,(AB333327:0.004104,AB333429:0.003915):-6.821e-05):0.000721):0.009930,((AB332511:0.006354,AB332521:0.017646):0.001969,(AB332817:0.002756,(AB333161:0.002406,AB333763:0.001594):0.001244):0.006950)Pleuromamma_xiphias:0.003804):0.049420):0.029012,(((AB332501:0.004351,((AB333166:0.001847,AB333654:0.000153):0.004858,AB333228:0.005142):-0.000637):0.005890,AB333571:0.012285):0.003680,(AB332547:0.004672,AB333517:0.003328):0.009091)Pleuromamma_scutullata :0.087404):0.001892,(((((((((AB332440:0.001382,AB332803:0.000618):0.001734,AB332707:0.004266):0.002074,AB332566:0.006682):0.000624,AB333722:0.002744):0.000369,(AB332748:0.002479,AB333307:0.001521):0.003261):0.032960,((AB333381:0.002728,AB333636:0.001272):0.017132,(AB333440:0.002243,(AB333574:0.000571,AB333669:0.001429):0.001765):0.012964):0.025199):0.016597,AB333288:0.054267):0.013270,AB333218:0.058963):0.015948,(AB333480:0.000787,AB333627:0.001213):0.084387):0.020929):0.019147,((((AB332525:0.006753,((AB333244:0.003004,(AB333391:0.003157,(AB333621:0,AB333725:0):0.000843):0.000731):0.000886,AB333724:0.001608):0.003017):0.103975,((((AB332850:0.003856,AB333729:0.002143):0.003111,AB333052:0.004894):0.000535,AB333116:0.005779):0.073896,((AB332927:0.002506,AB333047:0.001494):0.007920,AB333016:0.008080):0.067960):0.028025):0.003981,AB333334:0.111710):-0.001356,AB332646:0.096629):0.006927):-0.001779,((AB332485:0.125421,(AB332886:0.007874,AB332924:0.008178):0.112913):0.007311,(((((AB332830:0.008569,AB333766:0.005431):0.001277,AB333603:0.006723):0.001273,AB332896:0.010301):0.001767,AB332990:0.007884):0.097684,AB333751:0.100246):0.024111):-0.000936):0.006639,((((((((((((((AB332456:0.002147,AB333354:0.003939):0.000662,AB333004:0.005336):0.000391,AB332838:0.004705):0.001582,AB333675:0.004767):0.000916,((AB332475:0,AB333592:0):0.004191,(AB332985:0.004239,AB333432:0.003761):0.001809):0.001746):0.001394,(((AB332728:0.002028,AB332784:-1.998e-05):0.000511,AB333528:0.001477):0.000722,AB333709:0.003106):0.005807):0.002145,AB333231:0.007801):-0.000456,((((AB332479:0,AB333407:0):0,AB333476:0):0.009406,((((((AB332516:0.002343,AB333043:0.001662):0.002786,(AB332578:0.003397,AB332610:0.002603):0.001209):0.000589,AB333126:0.005413):0.000545,((AB332664:0.005785,AB332681:0.006215):0.000975,AB332960:0.007025):0.001447):0.000389,AB332735:0.005389):0.000586,(AB332743:0.005040,AB332955:0.004960):0.000715):0.001591):-0.000171,(AB332517:4.217e-08,AB332982:0.002000):0.006405):0.000553):0.000189,AB332584:0.006145):0.005718,(AB333039:0.012539,AB333273:0.007461):0.003393):0.005840,AB332724:0.024850):-0.001575,AB333197:0.013660):0.007568,((((AB332472:0.009290,(AB332701:0.007458,AB333684:0.006559):0.000699):0.001650,AB333225:0.010110):0.002342,(AB332778:0.001841,AB333311:0.002151):0.008736):0.006977,((AB333142:0.001233,AB333650:0.002784):0.013274,AB333144:0.016731):0.001729):0.005658):0.012913,AB332549:0.036457):0.080937):0.008065,((AB332454:0.101458,AB333077:0.098542):0.028923,(((AB332818:0.024572,(((AB332881:0.005472,(AB333111:0.006787,AB333459:0.005213):0.000528):0.001137,(AB333305:0.001825,AB333404:0.002175):0.002687):0.002413,AB332961:0.008124):0.006321):0.034219,AB333730:0.068664):0.029327,AB333017:0.082687):0.042071):0.007771):-0.008661,(((((((AB332455:0.006316,((AB332887:0.004632,AB333385:0.003368):0.000175,AB332902:0.001825):0.001636):0.001104,AB332804:0.006041):0.098927,(((AB332520:0.002461,(((((AB332726:0.001323,(AB332855:0.002000,((AB333238:0,AB333376:0):0,AB333563:0):-3.425e-07):0.000677):0.000614,AB332863:0.002980):-2.071e-05,AB332993:0.001341):0.000165,AB332866:0.003371):0.000959,AB333744:0.004565):0.000198):0.001240,AB332848:0.003730)Euchaeta_indica:0.012783,(((AB333022:0.001704,(AB333633:0.000754,AB333703:0.001254):0.000294):0.003953,AB333378:0.005960):0.005063,AB333469:0.012907):0.003843):0.093237):0.007118,((AB332721:0.099900,AB333050:0.108100):0.011340,(AB333162:0.095114,AB333482:0.104886):0.007660):-0.001482):0.003977,AB333268_Canthocalanus pauper:0.099861):0.001335,((((((AB332467:0.000785,AB333281:0.001215):0.009074,AB332826:0.019034):0.032585,AB333685:0.041773):0.040378,AB333700_Calocalanus:0.072586):0.003969,(AB333285:0.046555,AB333291:0.059445):0.025598):0.005682,AB333481:0.097018):0.010107):0.006128,((((AB332470:0.010465,(AB333561:0.010112,AB333694:0.009894):0.001529)Eucalanus_sewelli:0.083197,(((((((((AB332565:-0.000218,AB332921:0.004225):0.000109,AB332706:-0.000109):3.637e-05,AB333638:-7.268e-05):4.608e-05,AB332782:0.001920):0.000184,AB333664:0.003765):0.000270,AB332852:0.001574):0.000298,AB332755:0.003400):0.000141,AB333581:0.001407):0.000312,AB332898:0.003228):0.094362):-0.005323,(((((((((((((((((((((((((((((((AB332471:0.001365,((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((AB332473:7.371e-05,(((((((((((((AB332519:-0.000230,AB332713:0.000230):-0.000150,AB332628:0.002146):-4.865e-05,AB332564:0.002105):-2.930e-05,AB333164:0.002082):2.079e-05,AB333287:0.002028):-3.996e-05,AB332874:0.002057):-9.105e-06,AB333587:0.002050):-3.245e-06,(AB333038:0,AB333619:0):0.002041):-1.260e-05,AB333319:0.002038):-5.001e-06,AB333771:0.002036):-1.498e-06,AB332949:0.002032):6.452e-06,AB333511:0.002020):0.000785,AB332849:0.001233):-0.000740):-4.659e-06,AB332490:6.916e-05):-4.117e-06,AB332518:6.514e-05):-3.665e-06,AB332524:6.157e-05):-3.285e-06,AB332538:5.837e-05):-2.961e-06,AB332555:5.549e-05):-2.683e-06,AB332568:5.289e-05):-2.443e-06,AB332596:5.053e-05):-2.234e-06,AB332601:4.837e-05):-2.051e-06,AB332607:4.639e-05):-1.889e-06,AB332632:4.456e-05):-1.747e-06,AB332648:4.288e-05):-1.620e-06,AB332652:4.133e-05):-1.506e-06,AB332663:3.988e-05):-1.405e-06,AB332666:3.854e-05):-1.313e-06,AB332689:3.728e-05):-1.230e-06,AB332697:3.610e-05):-1.155e-06,AB332732:3.500e-05):-1.087e-06,AB332746:3.397e-05):-1.024e-06,AB332774:3.299e-05):-9.674e-07,AB332805:3.208e-05):-9.150e-07,AB332832:3.121e-05):-8.669e-07,AB332859:3.039e-05):-8.225e-07,AB332867:2.961e-05):-7.816e-07,AB332908:2.888e-05):-7.436e-07,AB332967:2.818e-05):-7.084e-07,AB332984:2.751e-05):-6.758e-07,AB333023:2.688e-05):-6.453e-07,AB333040:2.627e-05):-6.169e-07,AB333051:2.569e-05):-5.904e-07,AB333068:2.514e-05):-5.656e-07,AB333102:2.461e-05):-5.424e-07,AB333121:2.411e-05):-5.206e-07,AB333129:2.363e-05):-5.001e-07,AB333171:2.316e-05):-4.809e-07,AB333177:2.272e-05):-4.627e-07,AB333226:2.229e-05):-4.456e-07,AB333227:2.188e-05):-4.295e-07,AB333279:2.148e-05):-4.142e-07,AB333301:2.110e-05):-3.998e-07,AB333359:2.073e-05):-3.861e-07,AB333390:2.038e-05):-3.732e-07,AB333435:2.004e-05):-3.609e-07,AB333449:1.971e-05):-3.492e-07,AB333450:1.939e-05):-3.381e-07,AB333451:1.908e-05):-3.275e-07,AB333512:1.878e-05):-3.174e-07,AB333529:1.849e-05):-3.078e-07,AB333595:1.821e-05):-2.987e-07,AB333622:1.794e-05):-2.899e-07,AB333676:1.768e-05):-2.816e-07,AB333680:1.743e-05):-2.736e-07,AB333691:1.718e-05):-2.660e-07,AB333713:1.694e-05):-2.587e-07,AB333728:1.671e-05):-2.517e-07,AB333770:1.648e-05):-2.450e-07,AB333773:1.626e-05):-7.705e-06,AB333540:0.004024):5.612e-06,AB333454:0.002017):5.614e-05,AB332603:0.001961):0.000103,AB332843:0.005859):-0.000142,AB333070:0.002005):-1.458e-05,AB333266:0.002019):5.249e-06,AB333532:0.002014):0.000540,AB332834:0.001474):-0.000486,AB333211:0.001972):0.000525,AB332959:0.001448):-0.000419,AB332821:0.001881):0.000134,AB333752:0.001751):0.000248,(AB332626:0,AB333772:0):0.001508):-0.000254,AB332608:0.003785):0.000420,AB333065:0.001370):-0.000277,(AB332477:0,AB333604:0):0.001661):0.000104,AB333233:0.001571):4.037e-05,AB333692:0.003540):5.443e-05,AB333145:0.001496):-4.140e-05,AB333743:0.001548):-0.000216,AB333696:0.001774):0.000230,AB333414:0.001548):0.000210,AB333357:0.003348):-0.000646,AB333154:1.454e-05):-1.600e-07,AB333188:1.440e-05):-1.570e-07,AB333557:1.427e-05):0.000622,AB332502:0.001386):3.262e-05):-2.843e-06,AB333214:0.001380):0.000109,AB332736:0.001283):0.000499,(AB333229:0.000643,AB333379:0.001357):0.000799):-0.000588,(AB332583:-8.189e-05,AB333085:8.189e-05):0.001433):-0.000237,AB333518:0.001699):0.000523,(AB333010:0.001333,AB333646:0.002667):0.001173):-0.000597,AB333026:0.001799):0.000457,AB333149:0.001346):0.000579,AB333702:0.002780):-0.000415,AB332871:0.003216):-0.000220,AB332591:0.001448):0.000290,AB332861:0.001170):-0.000154,(AB332742:0.001097,AB333632:0.000899):0.000340):0.000173,AB332534:0.005186):-0.000237,AB332712:0.001436):9.495e-05,AB333629:0.003351):0.000557,((AB332550:0.000264,AB333453:-0.000264):0.000757,AB333374:0.001241):0.000560):0.000757,(AB332554:0.001159,((((AB332704:0.002001,AB332945:-1.169e-06):5.851e-07,AB333526:-5.851e-07):1.953e-07,AB333687:-3.904e-07):0.001639,AB332994:0.004361):-0.000142):0.000872):-0.001255,AB332730:0.001535):0.000303,AB332602:0.003237):-1.241e-05,AB332667:0.001261):0.000648,((((AB332674:0,AB332853:0):0,AB332950:0):0,AB333328:0):0.001420,(AB333235:0.007574,AB333309:0.002426):0.000580):0.000150):-0.000682,AB333364:0.001424):0.000327,AB333608:0.001105):-0.000322,AB333256:0.001440):0.000318,AB332685:0.003133):0.000548,AB332943:0.002596):0.000695,AB332876:0.001905):-0.000536,(AB332509:0.000655,AB332810:0.001369):0.000476):0.042384,AB332592:0.045985):0.032525):0.020457,AB332877:0.118710):0.006754):0.002400):0.023563,((((((((((AB332445:0.003178,AB333547:0.000822):0.001327,AB332747:0.002673):0.000401,AB332729:0.003824):0.000783,AB332941:0.003129):0.000141,(AB333046:0.003789,AB333316:0.006204):-0.000253):0.001592,AB332831:0.004292):-0.000119,((AB332836:0.001201,(AB333424:0.003956,(AB333586:0,AB333668:0):4.885e-05):0.000786):0.000575,AB333064:0.003024):0.002258):0.110702,(AB332965:0.001534,AB333400:0.004466):0.107768):0.020922,((((AB332507:0.001583,AB332944:0.000417):0.001294,AB333368:0.004706):0.013928,(AB332635:0.004882,AB333745:0.003118):0.010307):0.099832,AB333624:0.120629):0.018821):0.002149,AB333224:0.124638):0.012168):-0.015435,((((AB332449:0.001744,AB333652:0.004256):0.012352,(((((AB332465:0.007222,(AB332682:0.004250,((((AB332801:0,AB333201:0):0.001419,AB332978:0.004581):9.126e-05,AB333079:0.001434):0.000624,AB333662:0.003117):0.001206):0.002289):0.000630,AB333057:0.007115):0.000968,AB333066:0.004850):0.000340,(((((AB332491:0.001308,(((((AB332535:0,AB333601:0):0,AB333645:0):2.215e-06,AB333025:0.001998):7.016e-05,AB332964:0.001929):8.259e-05,AB332741:0.001875):0.000608):0.000685,AB332777:0.004821):0.000264,AB333360:0.004852):0.000485,(AB332940:0.004073,AB333658:0.003927):0.000622):0.000434,AB333213:0.002689):0.003043):0.002742,(AB333358:0.001711,AB333460:0.002289):0.005699):0.003055):0.000271,AB332493:0.011546):0.093921,(AB332651:0.008238,AB333760:0.005762)Candacia_longimana:0.098786):0.034802):0.003459,((((AB332484:0.004735,(AB332489:0.001317,((AB332571:0.002248,AB332723:-0.000242):0.001085,(((((AB332710:0,AB333045:0):0,AB333514:0):0,AB333537:0):0,AB333548:0):0,AB333757:0):0.000913):0.000227):0.000733):0.000190,AB332533:0.002798):0.001005,AB332798:0.002012):0.001331,(((((((AB332846:0,AB333321:0):0,AB333349:0):0.000502,AB333568:0.001498):0.000423,AB332869:0.001326):0.000207,AB333583:0.001389):0.000528,AB333361:0.001065):0.001665,AB333569:0.001667):0.000553)Candacia_truncata:0.136519):0.032025,(AB333303:0.152882,AB333683:0.145118):0.036830):0.009300,((((((((((AB332441:0.002071,AB333584:0.005929):0.003647,((((AB332526:0.002023,AB333606:-2.299e-05):1.553e-05,AB332643:0.001984):0.001127,AB332814:0.002868):0.000151,AB333409:0.001282):0.001923):0.002202,((((AB332469:-0.000109,(AB333223:0.001801,AB333721:0.004218):0.000106):3.888e-05,AB332816:0.001924):0.001052,AB333682:0.000912):0.000516,AB332693:0.000832):0.004301):0.101321,AB333318:0.096497):0.005357,(((AB332487:0.002039,AB333753:0.001961):0.017607,((((AB332673:0.002125,AB333248:0.005875):0.000635,(((AB332905:0.001367,AB333236:0.000633):0.000355,AB333489:-0.000357):0.001604,AB333533:0.002300):0.000499):0.003842,AB333127:0.008388):0.001438,(AB332962:0.000192,AB333148:0.001808):0.009107):0.006573):0.084308,(AB332977:0.014682,AB333403:0.021318):0.089962):0.004192):0.006790,AB333768:0.127034):0.018798,(AB332665:0.000634,AB332764:0.003366):0.142670):0.010376,((((AB332590:0.003877,((AB332639:0.003601,AB333566:0.004399):0.000108,AB332998:0.003892):8.724e-05):0.001580,AB333250:0.004359):0.080418,((AB332654:0.002185,AB333302:0.007815):0.087124,((AB332786:0,AB333525:0):0.001566,AB333089:0.002434):0.089021):0.000102):0.013561,(((((((AB332641:0,AB333707:0):0.001151,AB333134:0.002849):0.000610,AB333202:0.003006):0.000496,((AB332771:0,AB332892:0):0,AB333443:0):0.001007):0.001123,AB332668:0.003021):0.001163,AB332792:0.008103):0.000553,AB332725:0.001972):0.092796)Cephalopoda:0.032403):0.009303,((((((((AB332497:0,AB333484:0):0.000147,AB333056:0.001853):0.000667,(AB333117:0,AB333151:0):0.001284):0.000634,AB332907:0.001223):0.001875,AB333091:0.006273):0.003138,(((AB332802:0.004543,AB332909:0.001467):0.000888,AB333243:0.005117):0.000314,(AB333677:0.001714,(AB333693:0.002199,AB333742:0.003801):0.000286):0.001288):0.005055):0.108537,(((((AB332580:0.002796,AB333174:0.003204):0.001130,(((AB332692:3.006e-06,AB333422:0.001997):0.001631,AB333410:0.002369):0.000669,AB333297:0.003453):0.000597):0.001676,(AB333150:0.005257,(AB333497:0.001844,AB333639:0.004156):0.002743):-0.000214):0.004467,AB333399:0.008877):0.000806,(((((AB332621:0.005752,(AB332653:0.001992,(AB333350:0,AB333356:0):8.427e-06):0.000245):0.000503,AB333028:0.003373):0.000544,AB333312:0.003079):3.080e-05,AB332795:0.003407):0.006774,AB332970:0.010769):0.000546)Firoloida_nr_demarestia:0.091300):0.006159,((((AB332539:0.002739,AB333006:0.003261):0.001343,(AB333398:0.003313,AB333681:0.004687):0.000657):0.058816,AB333042_nr_Atlanta_peronii:0.059184):0.046348,(AB333506:0.083899,(AB333536:0.061687,AB333542_nr_Strombus_wilsoni:0.058313):0.020101):0.021528):0.000265):0.027979)gastropods:0.015095,((((((((AB332457:0.001998,AB333389:0.004002):5.503e-06,AB332656:-5.503e-06):1.837e-06,AB332775:-3.672e-06):9.200e-07,AB333294:-2.756e-06):5.528e-07,AB333748:-2.206e-06):0.000980,AB332642:0.001019):0.002206,AB332699:0.003094)Sternoptyx:0.116186,((((((((AB332458:0.000510,AB333012:0.001490):0.000696,((((((((AB332483:0,AB332763:0):0,AB332938:0):0,AB332953:0):0,AB333411:0):1.141e-06,AB333082:0.001999):6.317e-05,AB333642:0.003936):0.000548,AB333749:0.001406):0.000427,AB333577:0.001127):0.000625)Triphoturus_nigrescens:0.027908,AB333192:0.067330):0.054443,((((((((AB332733:0.001907,((((AB332765:0.004452,AB332900:-0.000454):0.000227,AB332930:-0.000227):7.585e-05,AB333419:0.001857):3.691e-05,AB332957:-0.000115):2.543e-05):0.000617,AB333686:0.001321):0.000242,AB333510:0.001271):0.000278,AB333099:0.001176):0.000163,AB332971:0.001196):0.000182,AB332914:0.003175):0.001161,AB333487:0.002164)Ceratoscopelus_warmingii:0.086597,AB333109:0.099443):-0.003091):0.010639,AB333523:0.095969):0.011271,(((((((((((((((((((((((((((((((((((AB332462:0,AB332500:0):0,AB332631:0):0,AB332691:0):0,AB332858:0):0,AB332873:0):0,AB332878:0):0,AB333081:0):0,AB333092:0):0,AB333230:0):0,AB333232:0):0,AB333306:0):0,AB333322:0):0,AB333433:0):0,AB333544:0):0,AB333573:0):-4.344e-07,AB332875:0.002000):2.549e-06,AB332915:0.001998):3.624e-06,AB332947:0.001994):6.128e-06,AB332999:0.001989):3.093e-05,AB333769:0.001959):0.000104,AB332928:0.001859):9.919e-05,AB333251:0.001773):-0.000172,AB332650:0.001964):0.000264,AB332510:0.003704):-0.000217,AB332992:0.003945):0.000607,AB333110:0.001337):-2.291e-05,AB333245:0.001413):9.918e-05,AB333299:0.001356):0.000209,AB332585:0.005192):-2.517e-05,AB332515:0.001271):6.751e-05,(AB333351:0.002382,AB333762:0.003620):0.000217):0.000401,AB332936:0.002942):0.000147,AB332671:0.002818):0.000337,AB333180:0.002588):-0.000173,AB332480:0.002838)Vinciguerria:0.105575):0.017587,(((((((AB332482:0.001786,((((((AB332738:-0.000274,AB333436:0.002284):0.000137,AB333264:-0.000137):4.571e-05,AB333335:-9.135e-05):2.632e-05,AB333097:0.001931):0.000258,AB333333:0.001701):0.000149,AB333158:0.001649):-3.457e-05):0.000318,AB333107:0.001531):0.000263,(AB332734:0.000513,AB333326:0.001487):0.001366):0.000105,AB333468:0.001491):0.000240,AB332680:0.001335):0.000151,AB332625:0.003287):8.867e-05,AB332563:0.003329)Cyclothone_pallida:0.123354):0.002853,AB332757:0.120516):0.008125)Vertebrata:0.044584):0.001716):-0.000545,(((((((((((((AB332446:0.001491,(((AB332453:0.001996,((((AB332841:2.347e-07,AB332931:0.002000):-1.174e-07,AB333247:1.175e-07):-3.922e-08,AB333516:7.836e-08):-1.964e-08,AB333723:5.881e-08):4.151e-06):0.000503,AB332523:0.001494):0.000226,AB332891:0.001413):6.928e-05):0.000328,(AB332508:0.006566,AB332679:0.005449):0.001167):0.000526,AB333098:0.003033):0.089275,AB333406:0.075610):0.007006,(((((AB332605:0.000150,AB333755:0.001850):0.000457,AB333605:0.001543):0.000824,AB333165:0.001024)Euphausia_sp:0.056791,AB333600_Euphausia_diomedeae:0.052721):0.027507,((AB332958:0.008747,AB333280:0.007253)Nematoscelis_sp:0.047595,(AB333219:0,AB333673:0):0.061405):0.013626):0.005945):0.001901,AB332505:0.087239):0.000281,(((((((((((((((((((((((AB332486:0,AB332695:0):0,AB332851:0):0,AB333205:0):0,AB333295:0):0,AB333392:0):0,AB333491:0):0,AB333524:0):0,AB333690:0):2.872e-06,AB333672:0.001997):0.000141,AB333679:0.001857):0.000153,AB333641:0.003730):-0.000160,AB333556:0.003935):0.000283,AB332868:0.001662):0.000179,AB333362:0.003532):0.000136,AB332606:0.001459):0.000155,AB333644:0.001371):-1.588e-05,AB333446:0.001461):-0.000158,AB332794:0.003685):0.000367,AB333494:0.001346):0.000141,AB332638:0.001271):0.001531,((AB332678:0.004939,AB333647:0.001061):0.000925,AB333147:0.001075):0.002168):-5.012e-05,AB333594:0.002407):0.001480,AB333313:0.005055):0.090549):0.007350,(((((((AB332468:0.001466,AB332617:0.000534):0.003740,AB332494:0.002260):0.000778,AB332714:0.005325):0.001562,AB332561:0.006094):0.000254,AB332624:0.004200):0.000776,AB332476:0.007358):0.000801,AB333032:0.007310)Thysanopoda:0.102802):0.003731,((AB332498:0.081409,((AB332556:0.013586,AB333055:0.014414):0.002836,((((((AB332800:0.003224,((AB333053:0.000423,AB333452:0.001577):0.000933,AB333463:0.003067):0.000465):-5.746e-06,AB333618:0.001618):6.595e-05,AB332933:0.001705):0.000854,AB333387:0.002949):0.000482,AB333330:0.004767):0.001524,(AB333195:0.001626,AB333373:0.002374):0.003551):0.008095):0.041815):0.053992,((((((((((((((AB332506:0.002004,AB332536:-4.085e-06):2.044e-06,AB332599:-2.044e-06):6.824e-07,AB333118:-1.364e-06):3.417e-07,AB333234:-1.024e-06):2.053e-07,AB333329:-8.195e-07):1.371e-07,AB333546:-6.834e-07):9.807e-08,AB333663:-5.862e-07):0.000204,AB333049:0.001796):0.000710,AB332702:0.001131):0.000124,AB332514:0.001180):0.001503,AB332781:0.005827):0.000368,AB332557:0.005832):0.096387,(((((AB332600:0.003187,AB333019:0.000813):0.001143,((AB333187:-0.000265,AB333539:0.002261):0.000531,AB333756:0.001481):0.002676):0.000644,AB333115:0.003586):0.083428,AB333370:0.080033):0.015586,((AB332894:0.001008,AB333003:0.000992):0.086263,AB333500:0.098737):0.012622):0.000624):0.014731,((AB333031:0,AB333200:0):0.000372,AB333124:0.001628):0.113651):0.004249):-0.001149):0.009752,((((((((AB332450:-0.000143,AB333585:0.000143):7.131e-05,AB332833:-7.131e-05):2.380e-05,AB333551:-4.757e-05):0.000124,AB333466:0.001854):0.001107,AB333215:0.002807):0.000893,AB333380:0.004309):0.065173,AB333024:0.081377):0.031652,(((AB332807:0.001785,(AB333141:0.000656,AB333372:0.001340):0.000226):0.000576,AB333386:0.003353):0.000394,AB333472:0.001281)Sergestidae:0.103686):0.001528):0.007911,(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((AB332448:-3.630e-06,(((((AB332459:0.002000,(((AB332827:0.001999,AB333439:0.002001):4.937e-07,AB333754:0.002000):5.245e-06,AB333062:0.001995):-2.208e-06):4.209e-06,AB332528:0.001995):1.804e-07,AB333315:0.001997):4.687e-06,AB332573:0.001993):5.722e-07,AB333342:0.001994):-8.761e-07):3.655e-07,AB332512:-3.269e-06):2.995e-07,AB332567:-2.974e-06):2.499e-07,AB332586:-2.729e-06):2.118e-07,AB332609:-2.521e-06):1.818e-07,AB332620:-2.342e-06):1.578e-07,AB332634:-2.188e-06):1.383e-07,AB332657:-2.053e-06):1.222e-07,AB332659:-1.933e-06):1.088e-07,AB332677:-1.827e-06):9.749e-08,AB332722:-1.733e-06):8.788e-08,AB332739:-1.647e-06):7.963e-08,AB332753:-1.570e-06):7.250e-08,AB332754:-1.500e-06):6.630e-08,AB332756:-1.436e-06):6.087e-08,AB332760:-1.377e-06):5.608e-08,AB332766:-1.323e-06):5.185e-08,AB332772:-1.273e-06):4.808e-08,AB332776:-1.227e-06):4.471e-08,AB332860:-1.184e-06):4.169e-08,AB332862:-1.144e-06):3.897e-08,AB332880:-1.107e-06):3.651e-08,AB332882:-1.072e-06):3.429e-08,AB332883:-1.039e-06):3.226e-08,AB332903:-1.008e-06):3.041e-08,AB332904:-9.793e-07):2.871e-08,AB332912:-9.521e-07):2.716e-08,AB332917:-9.264e-07):2.573e-08,AB332918:-9.020e-07):2.442e-08,AB332934:-8.790e-07):2.320e-08,AB332969:-8.571e-07):2.207e-08,AB332979:-8.363e-07):2.103e-08,AB332983:-8.165e-07):2.006e-08,AB332989:-7.977e-07):1.915e-08,AB332996:-7.798e-07):1.831e-08,AB333018:-7.626e-07):1.753e-08,AB333035:-7.463e-07):1.679e-08,AB333076:-7.306e-07):1.610e-08,AB333101:-7.156e-07):1.545e-08,AB333105:-7.013e-07):1.485e-08,AB333128:-6.875e-07):1.427e-08,AB333130:-6.742e-07):1.374e-08,AB333135:-6.615e-07):1.323e-08,AB333153:-6.493e-07):1.275e-08,AB333196:-6.376e-07):1.229e-08,AB333221:-6.263e-07):1.187e-08,AB333246:-6.153e-07):1.146e-08,AB333282:-6.048e-07):1.108e-08,AB333310:-5.947e-07):1.071e-08,AB333320:-5.849e-07):1.036e-08,AB333353:-5.754e-07):1.003e-08,AB333397:-5.663e-07):0,AB333447:-5.574e-07):0,AB333461:-5.489e-07):0,AB333464:-5.406e-07):0,AB333475:-5.326e-07):0,AB333479:-5.248e-07):0,AB333483:-5.172e-07):0,AB333495:-5.099e-07):0,AB333498:-5.028e-07):0,AB333552:-4.959e-07):0,AB333555:-4.892e-07):0,AB333565:-4.827e-07):0,AB333597:-4.764e-07):0,AB333631:-4.702e-07):0,AB333635:-4.642e-07):0,AB333655:-4.584e-07):0,AB333671:-4.527e-07):0,AB333697:-4.472e-07):0,AB333699:-4.418e-07):0,AB333732:-4.366e-07):0,AB333759:-4.315e-07):0,AB333765:-4.265e-07):-1.567e-06,AB332499:0.002001):3.821e-06,AB332531:0.001997):3.113e-06,AB333086:0.001994):-5.238e-06,AB332888:0.002000):3.670e-06,AB332975:0.001996):5.640e-08,AB332857:0.001996):8.134e-07,AB333531:0.001995):9.808e-05,AB332787:0.003897):5.002e-05,AB332522:0.001850):-0.000100,AB332752:0.001953):8.163e-06,(AB333278:0,AB333394:0):0.001946):9.827e-05,AB332478:0.001850):0.000105,AB332460:0.001748):3.199e-05,AB332920:0.001721):-1.871e-05,AB333504:0.005746):0.000148,AB332513:0.003603):-3.098e-05,AB333549:0.001642):1.733e-05,AB333492:0.003632):0.000147,AB333075:0.005492):-9.391e-08,AB333314:0.003502):-0.000184,AB332672:0.001696):9.678e-05,AB332636:0.001606):0.000254,AB333222:0.001359):-0.000400,AB333005:0.001771):0.000192,(AB333341:0.003100,AB333746:0.002900):0.000583):-7.004e-05,(AB333168:0.002296,AB333704:0.001704):0.000669):0.000208,(AB332694:0.000502,AB333113:0.001498):0.001473):-0.000261,AB332822:0.001752):0.000213,AB332700:0.001543):-9.236e-05,(AB333029:0.000647,AB333434:-0.000647):0.000644):0.000127,AB333719:0.001528):0.000146,(AB332981:1.740e-08,AB333423:0.002000):0.001390):0.000135,AB332553:0.001276):-0.000209,AB332504:0.003497):0.000190,AB333087:0.001315):-0.000125,(AB332919:0.002327,AB333438:0.001689):0.001448):8.741e-05,AB332696:0.001381):0.000145,AB332614:0.001246):2.971e-05,(((AB332604:0.001124,AB332865:0.004876):0.001200,AB333493:0.000800):0.000818,(AB332740:0.003257,(AB332906:0,AB332956:0):0.000743):0.001423):-0.000550):-5.540e-05,AB333550:0.001353):-1.675e-05,(AB333131:0.000566,AB333137:0.001434):0.001379):-3.886e-05,AB332856:0.003436):0.000169,AB332820:0.001275):1.059e-05,AB333736:0.001275):6.265e-05,AB333640:0.001223):9.478e-05,AB332466:0.001139):-8.231e-05,AB333090:0.001234):0.000213,AB333731:0.001031):-2.691e-05,(AB333527:0,AB333634:0):0.001072):0.000775,(AB332527:0.003564,AB332647:0.002436):0.000322):-0.000446,(AB332749:0.000138,AB333207:0.001862):0.000814):2.805e-05,AB333393:0.000817):6.005e-05,AB332630:0.000773):0.000128,AB332785:0.002661):0.000131,AB333708:0.002548):3.594e-05,AB333208:0.002531):0.000131,AB333108:0.002419):0.000274,AB333182:0.002165):0.129055):0.008170,((AB332796:0.000803,AB333701:0.003197):0.014115,AB333027:0.015885):0.130662):0.010763,((AB333308:0,AB333448:0):0.104348,AB333421:0.117652):0.043783):0.003332):0.004329,((((((((AB332463:0.000814,((((((((((((((((((((((((((((((((AB332545:-3.660e-06,((AB333060:0.001999,AB333741:0.002001):4.392e-06,AB333666:0.001996):2.196e-06):9.171e-07,AB332899:-2.747e-06):5.511e-07,AB332911:-2.199e-06):3.679e-07,AB332952:-1.834e-06):2.632e-07,AB333083:-1.573e-06):1.977e-07,AB333140:-1.378e-06):1.540e-07,AB333169:-1.226e-06):1.234e-07,AB333172:-1.104e-06):1.011e-07,AB333375:-1.004e-06):8.438e-08,AB333420:-9.213e-07):7.151e-08,AB333456:-8.510e-07):6.139e-08,AB333462:-7.908e-07):5.328e-08,AB333538:-7.387e-07):4.669e-08,AB333656:-6.930e-07):4.126e-08,AB333767:-6.528e-07):0.000105,AB332708:0.003894):-4.390e-05,AB333599:0.001949):0.000242,AB333710:0.001712):0.000190,AB332644:0.001549):-4.695e-05,AB333011:0.001634):2.189e-05,AB332976:-0.000353):0.000124,AB333240:0.001553):1.887e-05,AB333665:0.001570):0.000208,(AB333071:9.639e-05,AB333112:-9.639e-05):0.001399):1.583e-05,AB333651:0.001466):0.000119,AB333365:0.001382):0.000194,AB332718:0.003231):5.183e-05,AB332572:0.001228):0.000143,AB332922:0.003133):0.000108,AB332582:0.003079):0.000123,AB333764:0.003009):-7.422e-05,AB332913:0.001140):0.000372):0.000199,AB333596:0.000681):0.000183,AB332837:0.004567):0.000227,AB332780:0.002415):0.001037,(AB332615:0.003154,(AB332720:0.003988,AB333628:1.187e-05):0.000840):0.003084):0.000533,AB333175:0.003287):0.103161,(AB333352:0,AB333543:0):0.083155):0.019858,((((((((AB332542:0,AB333061:0):0,AB333194:0):0.000906,AB333007:0.001094):0.000622,AB332995:0.000925):0.003340,((AB332658:0,AB333199:0):0,AB333620:0):0.006014):0.069538,((((((((((AB332690:-6.055e-06,(AB333593:0.004009,AB333648:0.003991):6.055e-06):2.021e-06,AB333293:-4.040e-06):2.322e-06,AB333263:0.001996):0.000767,AB332711:0.001230):0.000781,AB333212:0.000706):0.000939,AB333455:0.004136):0.002672,(((((((AB332767:0,AB332884:0):0.001369,AB332789:0.000631):0.000584,(((AB332954:0,AB333186:0):0,AB333496:0):0.000572,AB333178:0.001428):0.001341):0.001601,(AB332815:0.001532,AB333401:0.004468):0.002453):0.000802,AB333260:0.004338):0.000749,AB332797:0.003921):0.000672,(AB332854:0.000877,AB333074:0.001123):0.002900):0.000861):0.000640,(AB333325:0.005957,(AB333417:0.002737,AB333643:0.003263):0.006043):-0.000702):0.021174,(AB332972:0.003921,AB333473:7.854e-05):0.028574):0.027114,((AB333155:0.003998,AB333347:1.519e-06):-7.600e-07,AB333413:7.600e-07):0.067257):0.026988):0.021746,AB333695:0.104523):0.007512,(((AB332916:0.000572,AB333712:0.001428):0.001227,AB333610:0.002796):0.077829,(AB333336:0.000682,AB333737:0.003328):0.069845):0.020300):0.008705):0.065544):-0.000127,((((((((((AB332442:0.004083,(AB332541:0.003392,(((AB332808:0,AB332823:0):0,AB333418:0):0.000311,AB332974:0.003689):0.000453):0.005553):0.005610,(AB333179:0.000662,AB333428:0.001338):0.012445):0.001808,((AB332829:0.002423,AB333344:0.003587):0.008098,(AB333290:0.014179,(AB333346:-1.158e-05,AB333541:0.002012):0.007821):0.002653):0.001379):0.001554,(((AB332751:0.001708,AB333427:0.000292):0.002245,AB333670:0.001766):0.010924,AB333716:0.014352):0.000848):0.000939,(AB333013:0.001466,AB333405:0.004534):0.013509):0.001261,(AB332660:0.001151,AB333612:0.000849):0.017408):0.077772,AB333688:0.111706):0.049193,(((((((((((AB332532:0.004242,(AB332987:0.001195,AB333249:0.002797):0.001777):0.002011,AB333371:0.005402):0.001203,(AB333000:0.001525,AB333698:0.000488):0.007513):0.007082,AB333467:0.014104):0.013304,AB332783:0.029637):0.012263,((AB332633:0.008359,(AB333190:0.000961,AB333508:0.001039):0.003641):0.022923,(AB332731:0.023721,AB333262:0.024290):0.007529):0.009770)chaetognaths:0.076836,(((((((((((AB332594:0.003944,AB333338:5.568e-05):0.004263,((AB333123:0.001991,AB333210:0.002026):0.001346,AB333183:0.004652):0.001283):0.000980,AB333415:0.002674):0.000760,((AB333088:0.008243,AB333254:0.003757):0.000467,(AB333184:0.002816,(AB333408:0.000941,AB333425:0.003063):0.001202):0.003799):0.000314):0.001560,AB333156:0.006354):0.003871,((AB332951:0.002675,AB333564:0.007330):0.006847,((AB333009:0.010046,((AB333084:-0.000251,AB333269:0.000251):0.010027,(AB333209:0.000812,AB333590:0.005205):0.008010):-5.504e-05):-0.000261,((AB333059:0.002228,AB333591:-0.000220):0.006670,AB333100:0.005331):0.001398):0.000992):0.004358):0.001015,AB333426:0.019582):-9.022e-05,((((((AB332759:0.000249,AB333170:-0.000249):0.000126,AB333343:0.001878):4.136e-05,AB333607:0.001918):2.581e-05,AB333615:0.001933):0.000439,AB332762:0.003527):0.001124,AB333271:0.006564):0.010302):0.004713,AB333337:0.016744):0.007278,AB332946:0.023407):0.027356,((AB332670:0.002502,(((AB332939:0.002076,AB333252:-6.311e-05):7.654e-05,AB333470:0.003919):3.834e-05,AB333257:-6.510e-05):0.001474):0.017261,(AB332799:0.002874,AB333747:0.003126):0.017072):0.030164):0.060585):0.011175,AB333617:0.122081):0.010375,(((((AB332629:0.007868,(AB332840:0.008663,AB333598:0.007337):0.002132):0.002712,(AB332811:0.009647,AB333614:0.006353):0.002578):0.026784,(AB332768:0.013947,AB332806:0.016053):0.029731):0.050309,AB333034:0.061861):0.032018,((AB332640:0.002321,AB333048:0.001679):0.136963,(AB332683:0.001083,(AB333173:0.000913,AB333431:0.005087):0.000917):0.137731):0.008720):0.017450):0.002525,AB333589:0.137126):0.015916,(AB333339:0.000930,AB333355:0.001070):0.150580):0.003208):0.006621,(AB333616:0.023371,AB333715:0.020629):0.140845):-0.003064,AB333733:0.136348):0.042862):0,(((((((AB332439:0.005182,((AB332715:-4.104e-05,(((AB332790:0,AB332889:0):0.002005,AB333036:-4.706e-06):1.571e-06,AB333041:-3.140e-06):4.689e-05):0.000255,AB332968:0.003719):0.000631):0.000271,AB333220:0.003178):0.002728,((((((AB332540:0,AB332551:0):0.003398,AB333265:0.002602):0.000498,(((AB332570:0.003734,(AB333080:-3.881e-06,AB333332:0.002004):0.000266):0.000697,AB333649:0.001214):0.000850,((AB332737:0.001296,AB333499:0.000704):0.000369,AB332791:0.001631):0.000634):0.000382):0.000336,(((AB332597:0.003555,(AB332963:0.001758,AB333203:0.000242):0.000435):0.000551,AB333727:0.003312):0.000324,(AB332598:0,AB333340:0):0.001325):0.001563):0.000768,(AB332744:0.000469,AB333216:0.001531):0.003176):0.000210,AB333513:0.003149):-0.000158):0.001247,(AB332872:0.001989,AB332980:0.004011):0.003625):0.014380,((AB332623:8.708e-07,AB332709:0.001999):0.005999,AB333176:0.004001):0.014207):0.077394,((AB332576:0.001043,(((AB332637:0,AB332809:0):0,AB333073:0):1.611e-06,AB333289:-1.611e-06):0.000958):0.094213,((((AB332769:-8.399e-05,AB333478:8.399e-05):0.001965,((AB333138:9.854e-07,AB333300:0.001999):-4.930e-07,AB333522:4.931e-07):3.723e-05):0.004036,AB333625:0.001955):0.089774,AB333277:0.087935):0.000858):0.006421)ostracods:0.093937,(((((AB332612:0.000548,AB332622:-0.000548):0.000773,AB332948:0.001225):0.001060,AB333758:0.000686):0.170973,(AB332687:0.004777,AB333152:0.005223):0.157480):0.073152,(AB333163:0.248417,(AB333261:0.198888,AB333292:0.195627):0.011185):0.002130):0.000732):0.015673);';
	
	make_tiles($treestring, '../demo/tiles', '');
}

?>